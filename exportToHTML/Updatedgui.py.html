<html>
<head>
<title>Updatedgui.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #2aacb8;}
.s4 { color: #6aab73;}
.s5 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Updatedgui.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">sys</span>
<span class="s0">import </span><span class="s1">os</span>
<span class="s0">import </span><span class="s1">socket</span>
<span class="s0">import </span><span class="s1">re</span>
<span class="s0">import </span><span class="s1">subprocess</span>
<span class="s0">from </span><span class="s1">PyQt5</span><span class="s2">.</span><span class="s1">QtWidgets </span><span class="s0">import </span><span class="s1">QApplication</span><span class="s2">, </span><span class="s1">QMainWindow</span><span class="s2">, </span><span class="s1">QLabel</span><span class="s2">, </span><span class="s1">QPushButton</span><span class="s2">, </span><span class="s1">QInputDialog</span><span class="s2">, </span><span class="s1">QMessageBox</span><span class="s2">, </span><span class="s1">QProgressDialog</span>
<span class="s0">from </span><span class="s1">PyQt5</span><span class="s2">.</span><span class="s1">QtGui </span><span class="s0">import </span><span class="s1">QColor</span><span class="s2">, </span><span class="s1">QFont</span><span class="s2">, </span><span class="s1">QPixmap</span><span class="s2">, </span><span class="s1">QIcon</span>
<span class="s0">from </span><span class="s1">PyQt5</span><span class="s2">.</span><span class="s1">QtCore </span><span class="s0">import </span><span class="s1">QSize</span><span class="s2">, </span><span class="s1">Qt</span>


<span class="s0">class </span><span class="s1">MyWindow</span><span class="s2">(</span><span class="s1">QMainWindow</span><span class="s2">):</span>
    <span class="s0">def </span><span class="s1">__init__</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">super</span><span class="s2">().</span><span class="s1">__init__</span><span class="s2">()</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">setGeometry</span><span class="s2">(</span><span class="s3">200</span><span class="s2">, </span><span class="s3">200</span><span class="s2">, </span><span class="s3">400</span><span class="s2">, </span><span class="s3">400</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">setWindowTitle</span><span class="s2">(</span><span class="s4">'Dynamism.Life'</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">setStyleSheet</span><span class="s2">(</span><span class="s4">&quot;background-color: #353535;&quot;</span><span class="s2">)</span>
        <span class="s1">self</span><span class="s2">.</span><span class="s1">initUI</span><span class="s2">()</span>

    <span class="s0">def </span><span class="s1">initUI</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s1">label </span><span class="s2">= </span><span class="s1">QLabel</span><span class="s2">(</span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">pixmap </span><span class="s2">= </span><span class="s1">QPixmap</span><span class="s2">(</span><span class="s4">'pics/Dynamism.Life-1.1.png'</span><span class="s2">)</span>
        <span class="s1">pixmap </span><span class="s2">= </span><span class="s1">pixmap</span><span class="s2">.</span><span class="s1">scaledToWidth</span><span class="s2">(</span><span class="s3">250</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">setPixmap</span><span class="s2">(</span><span class="s1">pixmap</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">setFixedSize</span><span class="s2">(</span><span class="s1">pixmap</span><span class="s2">.</span><span class="s1">width</span><span class="s2">(), </span><span class="s1">pixmap</span><span class="s2">.</span><span class="s1">height</span><span class="s2">())</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">move</span><span class="s2">(</span><span class="s3">70</span><span class="s2">, </span><span class="s3">0</span><span class="s2">)</span>

        <span class="s1">label </span><span class="s2">= </span><span class="s1">QLabel</span><span class="s2">(</span><span class="s4">'Welcome!'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">move</span><span class="s2">(</span><span class="s3">150</span><span class="s2">, </span><span class="s3">220</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">setFont</span><span class="s2">(</span><span class="s1">QFont</span><span class="s2">(</span><span class="s4">'Helvetica'</span><span class="s2">, </span><span class="s3">17</span><span class="s2">))  </span><span class="s5"># set font for label</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">setStyleSheet</span><span class="s2">(</span><span class="s4">'color: white; font-weight: bold;'</span><span class="s2">)</span>

        <span class="s1">label </span><span class="s2">= </span><span class="s1">QLabel</span><span class="s2">(</span><span class="s4">'Select one:'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">move</span><span class="s2">(</span><span class="s3">60</span><span class="s2">, </span><span class="s3">270</span><span class="s2">)</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">setFont</span><span class="s2">(</span><span class="s1">QFont</span><span class="s2">(</span><span class="s4">'Helvetica'</span><span class="s2">, </span><span class="s3">12</span><span class="s2">))  </span><span class="s5"># set font for label</span>
        <span class="s1">label</span><span class="s2">.</span><span class="s1">setStyleSheet</span><span class="s2">(</span><span class="s4">'color: white; font-weight: bold;'</span><span class="s2">)</span>

        <span class="s1">button </span><span class="s2">= </span><span class="s1">QPushButton</span><span class="s2">(</span><span class="s4">'Sender'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">move</span><span class="s2">(</span><span class="s3">50</span><span class="s2">, </span><span class="s3">300</span><span class="s2">)</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">setStyleSheet</span><span class="s2">(</span><span class="s4">&quot;background-color: #e8e8e8; border: 2px solid white;&quot;</span><span class="s2">)</span>
        <span class="s1">pixmap </span><span class="s2">= </span><span class="s1">QPixmap</span><span class="s2">(</span><span class="s4">'pics/sending.png'</span><span class="s2">)</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">setIcon</span><span class="s2">(</span><span class="s1">QIcon</span><span class="s2">(</span><span class="s1">pixmap</span><span class="s2">))</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">setIconSize</span><span class="s2">(</span><span class="s1">QSize</span><span class="s2">(</span><span class="s3">20</span><span class="s2">, </span><span class="s3">20</span><span class="s2">))</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">clicked</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">Sender_application</span><span class="s2">)</span>

        <span class="s1">button </span><span class="s2">= </span><span class="s1">QPushButton</span><span class="s2">(</span><span class="s4">'Receiver'</span><span class="s2">, </span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">move</span><span class="s2">(</span><span class="s3">240</span><span class="s2">, </span><span class="s3">300</span><span class="s2">)</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">setStyleSheet</span><span class="s2">(</span><span class="s4">&quot;background-color: #e8e8e8; border: 2px solid white;&quot;</span><span class="s2">)</span>
        <span class="s1">pixmap </span><span class="s2">= </span><span class="s1">QPixmap</span><span class="s2">(</span><span class="s4">'pics/receive.png'</span><span class="s2">)</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">setIcon</span><span class="s2">(</span><span class="s1">QIcon</span><span class="s2">(</span><span class="s1">pixmap</span><span class="s2">))</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">setIconSize</span><span class="s2">(</span><span class="s1">QSize</span><span class="s2">(</span><span class="s3">20</span><span class="s2">, </span><span class="s3">20</span><span class="s2">))</span>
        <span class="s1">button</span><span class="s2">.</span><span class="s1">clicked</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(</span><span class="s1">self</span><span class="s2">.</span><span class="s1">Receiver_application</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">Sender_application</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
         <span class="s5"># Execute the ifconfig command and get its output</span>
        <span class="s1">output </span><span class="s2">= </span><span class="s1">subprocess</span><span class="s2">.</span><span class="s1">check_output</span><span class="s2">([</span><span class="s4">&quot;ifconfig&quot;</span><span class="s2">])</span>

        <span class="s5"># Use regular expressions to extract the IPv4 address of the first non-loopback interface</span>
        <span class="s1">ipv4_regex </span><span class="s2">= </span><span class="s1">re</span><span class="s2">.</span><span class="s1">compile</span><span class="s2">(</span><span class="s4">r&quot;inet (\d+\.\d+\.\d+\.\d+) &quot;</span><span class="s2">)</span>
        <span class="s1">match </span><span class="s2">= </span><span class="s1">ipv4_regex</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s1">str</span><span class="s2">(</span><span class="s1">output</span><span class="s2">, </span><span class="s4">&quot;utf-8&quot;</span><span class="s2">))</span>
        <span class="s0">if </span><span class="s1">match</span><span class="s2">:</span>
            <span class="s1">ip </span><span class="s2">= </span><span class="s1">match</span><span class="s2">.</span><span class="s1">group</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s4">&quot;IPv4 address:&quot;</span><span class="s2">, </span><span class="s1">ip</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s4">&quot;Could not find IPv4 address&quot;</span><span class="s2">)</span>

        <span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">information</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Current IP Address'</span><span class="s2">, </span><span class="s4">f'The current IP address is: </span><span class="s0">{</span><span class="s1">ip</span><span class="s0">}</span><span class="s4">'</span><span class="s2">)</span>

        <span class="s5"># Get IP address input from user</span>
        <span class="s1">ip_addr</span><span class="s2">, </span><span class="s1">ok </span><span class="s2">= </span><span class="s1">QInputDialog</span><span class="s2">.</span><span class="s1">getText</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Enter IP address'</span><span class="s2">, </span><span class="s4">'IP address:'</span><span class="s2">)</span>
        <span class="s0">if not </span><span class="s1">ok</span><span class="s2">:</span>
            <span class="s0">return</span>

        <span class="s5"># Set up progress dialog</span>
        <span class="s1">progress </span><span class="s2">= </span><span class="s1">QProgressDialog</span><span class="s2">(</span><span class="s4">'Running scripts...'</span><span class="s2">, </span><span class="s4">'Cancel'</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">setWindowTitle</span><span class="s2">(</span><span class="s4">'Please wait'</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">setWindowModality</span><span class="s2">(</span><span class="s1">Qt</span><span class="s2">.</span><span class="s1">WindowModal</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">setMinimumDuration</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">show</span><span class="s2">()</span>
        <span class="s1">app</span><span class="s2">.</span><span class="s1">processEvents</span><span class="s2">()</span>

	
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">output </span><span class="s2">= </span><span class="s1">subprocess</span><span class="s2">.</span><span class="s1">check_output</span><span class="s2">([</span><span class="s4">'ping'</span><span class="s2">, </span><span class="s4">'-c'</span><span class="s2">, </span><span class="s4">'3'</span><span class="s2">, </span><span class="s1">ip_addr</span><span class="s2">], </span><span class="s1">timeout</span><span class="s2">=</span><span class="s3">4</span><span class="s2">)</span>
            <span class="s1">ping_success </span><span class="s2">= </span><span class="s4">'0% packet loss' </span><span class="s0">in </span><span class="s1">output</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">()</span>
        <span class="s0">except </span><span class="s1">subprocess</span><span class="s2">.</span><span class="s1">TimeoutExpired</span><span class="s2">:</span>
            <span class="s1">ping_success </span><span class="s2">= </span><span class="s0">False</span>

        <span class="s5">#ping_progress.close()</span>

        <span class="s0">if not </span><span class="s1">ping_success</span><span class="s2">:</span>
            <span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">critical</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Error'</span><span class="s2">, </span><span class="s4">f'Unable to connect to IP address: </span><span class="s0">{</span><span class="s1">ip_addr</span><span class="s0">}</span><span class="s4">'</span><span class="s2">, </span><span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">Ok</span><span class="s2">)</span>
            <span class="s0">return</span>

        <span class="s5"># Run long operation</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s5"># Rest of the method</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">'echo &quot;Y&quot; | sudo apt-get install nfs-kernel-server nfs-common'</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo systemctl restart nfs-kernel-server&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo mkdir /swap_share&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo chmod 777 /swap_share&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">f'sudo sh -c &quot;echo </span><span class="s0">\'</span><span class="s4">/swap_share </span><span class="s0">{</span><span class="s1">ip_addr</span><span class="s0">}</span><span class="s4">(rw,sync,no_subtree_check)</span><span class="s0">\' </span><span class="s4">&gt;&gt; /etc/exports&quot;'</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo systemctl restart nfs-kernel-server&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo fallocate -l 4G /swapfile_network&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo chmod 600 /swapfile_network&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo mkswap /swapfile_network&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo mv /swapfile_network /swap_share/&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo chmod 777 /swap_share/swapfile_network&quot;</span><span class="s2">)</span>
            <span class="s5">#sys.exit()</span>

            <span class="s5"># Close progress dialog and show completion message</span>
            <span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">msg_box </span><span class="s2">= </span><span class="s1">QMessageBox</span><span class="s2">()</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">setText</span><span class="s2">(</span><span class="s4">'The operation completed successfully.'</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">setWindowTitle</span><span class="s2">(</span><span class="s4">'Operation completed'</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">setStandardButtons</span><span class="s2">(</span><span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">Ok</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">finished</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(</span><span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">exec_</span><span class="s2">()</span>

        <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
            <span class="s5"># Close progress dialog and show error message</span>
            <span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">critical</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Error'</span><span class="s2">, </span><span class="s1">str</span><span class="s2">(</span><span class="s1">e</span><span class="s2">), </span><span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">Ok</span><span class="s2">)</span>

            


    <span class="s0">def </span><span class="s1">Receiver_application</span><span class="s2">(</span><span class="s1">self</span><span class="s2">):</span>
        <span class="s5"># Execute the ifconfig command and get its output</span>
        <span class="s1">output </span><span class="s2">= </span><span class="s1">subprocess</span><span class="s2">.</span><span class="s1">check_output</span><span class="s2">([</span><span class="s4">&quot;ifconfig&quot;</span><span class="s2">])</span>

        <span class="s5"># Use regular expressions to extract the IPv4 address of the first non-loopback interface</span>
        <span class="s1">ipv4_regex </span><span class="s2">= </span><span class="s1">re</span><span class="s2">.</span><span class="s1">compile</span><span class="s2">(</span><span class="s4">r&quot;inet (\d+\.\d+\.\d+\.\d+) &quot;</span><span class="s2">)</span>
        <span class="s1">match </span><span class="s2">= </span><span class="s1">ipv4_regex</span><span class="s2">.</span><span class="s1">search</span><span class="s2">(</span><span class="s1">str</span><span class="s2">(</span><span class="s1">output</span><span class="s2">, </span><span class="s4">&quot;utf-8&quot;</span><span class="s2">))</span>
        <span class="s0">if </span><span class="s1">match</span><span class="s2">:</span>
            <span class="s1">ip </span><span class="s2">= </span><span class="s1">match</span><span class="s2">.</span><span class="s1">group</span><span class="s2">(</span><span class="s3">1</span><span class="s2">)</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s4">&quot;IPv4 address:&quot;</span><span class="s2">, </span><span class="s1">ip</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">print</span><span class="s2">(</span><span class="s4">&quot;Could not find IPv4 address&quot;</span><span class="s2">)</span>

        <span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">information</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Current IP Address'</span><span class="s2">, </span><span class="s4">f'The current IP address is: </span><span class="s0">{</span><span class="s1">ip</span><span class="s0">}</span><span class="s4">'</span><span class="s2">)</span>

        <span class="s5"># Get IP address input from user</span>
        <span class="s1">ip_addr</span><span class="s2">, </span><span class="s1">ok </span><span class="s2">= </span><span class="s1">QInputDialog</span><span class="s2">.</span><span class="s1">getText</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Enter IP address'</span><span class="s2">, </span><span class="s4">'IP address:'</span><span class="s2">)</span>
        <span class="s0">if not </span><span class="s1">ok</span><span class="s2">:</span>
            <span class="s0">return</span>

        <span class="s5"># Set up progress dialog</span>
        <span class="s1">progress </span><span class="s2">= </span><span class="s1">QProgressDialog</span><span class="s2">(</span><span class="s4">'Running scripts...'</span><span class="s2">, </span><span class="s4">'Cancel'</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s3">0</span><span class="s2">, </span><span class="s1">self</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">setWindowTitle</span><span class="s2">(</span><span class="s4">'Please wait'</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">setWindowModality</span><span class="s2">(</span><span class="s1">Qt</span><span class="s2">.</span><span class="s1">WindowModal</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">setMinimumDuration</span><span class="s2">(</span><span class="s3">0</span><span class="s2">)</span>
        <span class="s1">progress</span><span class="s2">.</span><span class="s1">show</span><span class="s2">()</span>
        <span class="s1">app</span><span class="s2">.</span><span class="s1">processEvents</span><span class="s2">()</span>


        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">output </span><span class="s2">= </span><span class="s1">subprocess</span><span class="s2">.</span><span class="s1">check_output</span><span class="s2">([</span><span class="s4">'ping'</span><span class="s2">, </span><span class="s4">'-c'</span><span class="s2">, </span><span class="s4">'3'</span><span class="s2">, </span><span class="s1">ip_addr</span><span class="s2">], </span><span class="s1">timeout</span><span class="s2">=</span><span class="s3">4</span><span class="s2">)</span>
            <span class="s1">ping_success </span><span class="s2">= </span><span class="s4">'0% packet loss' </span><span class="s0">in </span><span class="s1">output</span><span class="s2">.</span><span class="s1">decode</span><span class="s2">()</span>
        <span class="s0">except </span><span class="s1">subprocess</span><span class="s2">.</span><span class="s1">TimeoutExpired</span><span class="s2">:</span>
            <span class="s1">ping_success </span><span class="s2">= </span><span class="s0">False</span>

        <span class="s5">#ping_progress.close()</span>

        <span class="s0">if not </span><span class="s1">ping_success</span><span class="s2">:</span>
            <span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">critical</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Error'</span><span class="s2">, </span><span class="s4">f'Unable to connect to IP address: </span><span class="s0">{</span><span class="s1">ip_addr</span><span class="s0">}</span><span class="s4">'</span><span class="s2">, </span><span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">Ok</span><span class="s2">)</span>
            <span class="s0">return</span>

        <span class="s5"># Run long operation</span>
        <span class="s0">try</span><span class="s2">:</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">'echo &quot;Y&quot; | sudo apt-get install nfs-kernel-server nfs-common'</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo systemctl restart nfs-kernel-server&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo mkdir /swap_mount&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo chmod 777 /swap_mount&quot;</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">f'sudo mount </span><span class="s0">{</span><span class="s1">ip_addr</span><span class="s0">}</span><span class="s4">:/swap_share /swap_mount'</span><span class="s2">)</span>
            <span class="s1">os</span><span class="s2">.</span><span class="s1">system</span><span class="s2">(</span><span class="s4">&quot;sudo swapon /swap_mount/swapfile_network&quot;</span><span class="s2">)</span>
            <span class="s5"># sys.exit()</span>

            <span class="s5"># Close progress dialog and show completion message</span>
            <span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">msg_box </span><span class="s2">= </span><span class="s1">QMessageBox</span><span class="s2">()</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">setText</span><span class="s2">(</span><span class="s4">'The operation completed successfully.'</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">setWindowTitle</span><span class="s2">(</span><span class="s4">'Operation completed'</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">setStandardButtons</span><span class="s2">(</span><span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">Ok</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">finished</span><span class="s2">.</span><span class="s1">connect</span><span class="s2">(</span><span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">)</span>
            <span class="s1">msg_box</span><span class="s2">.</span><span class="s1">exec_</span><span class="s2">()</span>

        <span class="s0">except </span><span class="s1">Exception </span><span class="s0">as </span><span class="s1">e</span><span class="s2">:</span>
            <span class="s5"># Close progress dialog and show error message</span>
            <span class="s1">progress</span><span class="s2">.</span><span class="s1">close</span><span class="s2">()</span>
            <span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">critical</span><span class="s2">(</span><span class="s1">self</span><span class="s2">, </span><span class="s4">'Error'</span><span class="s2">, </span><span class="s1">str</span><span class="s2">(</span><span class="s1">e</span><span class="s2">), </span><span class="s1">QMessageBox</span><span class="s2">.</span><span class="s1">Ok</span><span class="s2">)</span>


<span class="s0">if </span><span class="s1">__name__ </span><span class="s2">== </span><span class="s4">'__main__'</span><span class="s2">:</span>
    <span class="s1">app </span><span class="s2">= </span><span class="s1">QApplication</span><span class="s2">(</span><span class="s1">sys</span><span class="s2">.</span><span class="s1">argv</span><span class="s2">)</span>
    <span class="s1">app</span><span class="s2">.</span><span class="s1">setStyle</span><span class="s2">(</span><span class="s4">&quot;Fusion&quot;</span><span class="s2">)</span>

    <span class="s1">window </span><span class="s2">= </span><span class="s1">MyWindow</span><span class="s2">()</span>

    <span class="s1">window</span><span class="s2">.</span><span class="s1">show</span><span class="s2">()</span>
    <span class="s1">sys</span><span class="s2">.</span><span class="s1">exit</span><span class="s2">(</span><span class="s1">app</span><span class="s2">.</span><span class="s1">exec_</span><span class="s2">())</span>
</pre>
</body>
</html>